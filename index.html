
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>酒精換算器 alcohol-check</title>
  <style>
    body { font-family: Arial; max-width: 400px; margin:auto; padding:20px; }
    .hidden { display:none; }
    input, select, button { width: 100%; margin: 8px 0; padding: 8px; }
    table { width:100%; border-collapse:collapse; margin-top:10px; }
    td, th { border:1px solid #ccc; padding:5px; text-align:center; }
  </style>
</head>
<body>
  <h2>酒精單位換算器</h2>
  <button id="switchMode">切換到登入模式</button>

  <div id="guestMode">
    <h3>◆ 試算模式（不儲存）</h3>
    <select id="drinkGuest">
      <option value="5">啤酒 5%</option>
      <option value="12">紅酒 12%</option>
      <option value="15">清酒 15%</option>
      <option value="58">高粱 58%</option>
      <option value="40">威士忌 40%</option>
      <option value="20">米酒 20%</option>
    </select>
    <input id="mlGuest" type="number" placeholder="飲用量 (ml)">
    <button onclick="calcGuest()">換算</button>
    <div id="resultGuest"></div>
  </div>

  <div id="loginMode" class="hidden">
    <h3>◆ 登入模式（可儲存）</h3>
    <select id="drinkLogin">
      <option value="5">啤酒 5%</option>
      <option value="12">紅酒 12%</option>
      <option value="15">清酒 15%</option>
      <option value="58">高粱 58%</option>
      <option value="40">威士忌 40%</option>
      <option value="20">米酒 20%</option>
    </select>
    <input id="mlLogin" type="number" placeholder="飲用量 (ml)">
    <button onclick="calcLogin()">儲存記錄</button>
    <div id="resultLogin"></div>
    <h4>歷史紀錄</h4>
    <table id="logTable">
      <tr><th>日期</th><th>酒類 %</th><th>ml</th><th>單位</th></tr>
    </table>
    <div id="sumPerDay"></div>
  </div>

  <script>
    const switchBtn = document.getElementById('switchMode');
    switchBtn.addEventListener('click', () => {
      document.getElementById('guestMode').classList.toggle('hidden');
      document.getElementById('loginMode').classList.toggle('hidden');
      switchBtn.textContent = switchBtn.textContent.includes('登入') ? '切換到試算模式' : '切換到登入模式';
    });

    function calcGuest(){
      const p = +document.getElementById('drinkGuest').value;
      const ml = +document.getElementById('mlGuest').value;
      const g = ml * p/100 * 0.789;
      const u = (g/10).toFixed(2);
      document.getElementById('resultGuest').textContent = `酒精單位：${u}`;
    }

    function calcLogin(){
      const p = +document.getElementById('drinkLogin').value;
      const ml = +document.getElementById('mlLogin').value;
      const g = ml * p/100 * 0.789;
      const u = +((g/10).toFixed(2));
      const date = new Date().toISOString().split('T')[0];
      const logs = JSON.parse(localStorage.getItem('logs')||'[]');
      logs.push({date,p,ml,u});
      localStorage.setItem('logs', JSON.stringify(logs));
      renderLogs();
      document.getElementById('resultLogin').textContent = `本次單位：${u}`;
    }

    function renderLogs(){
      const logs = JSON.parse(localStorage.getItem('logs')||'[]');
      const table = document.getElementById('logTable');
      table.innerHTML = '<tr><th>日期</th><th>酒類 %</th><th>ml</th><th>單位</th></tr>';
      const today = new Date().toISOString().split('T')[0];
      let sum = 0;
      logs.forEach(r => {
        const row = table.insertRow();
        row.insertCell().textContent = r.date;
        row.insertCell().textContent = r.p;
        row.insertCell().textContent = r.ml;
        row.insertCell().textContent = r.u;
        if(r.date===today) sum += r.u;
      });
      document.getElementById('sumPerDay').textContent = `今日總單位：${sum.toFixed(2)}`;
    }

    renderLogs();
  </script>
</body>
</html>
